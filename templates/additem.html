<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{{ is_update and 'Update' or 'Add' }} Item - CENGden</title>
<style>
    * {box-sizing: border-box;}

    .container {
        padding: 16px;
        background-color: white;
        width: 100%;
        max-width: 600px;
        margin: 20px auto;
    }

    input[type=text], input[type=number], input[type=url], select, textarea {
        width: 100%;
        padding: 15px;
        margin: 5px 0 22px 0;
        display: inline-block;
        border: 1px solid #ccc;
        background: #f1f1f1;
    }

    input[type=text]:focus, input[type=number]:focus, input[type=url]:focus, select:focus, textarea:focus {
        background-color: #ddd;
        outline: none;
    }

    hr {
        border: 1px solid #f1f1f1;
        margin-bottom: 25px;
    }

    .additembtn {
        background-color: #007bff;
        color: white;
        padding: 16px 20px;
        margin: 8px 0;
        border: none;
        cursor: pointer;
        width: 100%;
        opacity: 0.9;
    }

    .additembtn:hover {
        opacity:1;
    }

    .field {
        display: none;
    }

    /* Additional styles */
</style>

<script>
    function showFields() {
        var category = document.getElementById("category").value;
        var fields = document.getElementsByClassName("field");
        for (var i = 0; i < fields.length; i++) {
            fields[i].style.display = "none";
            disableFields(fields[i], true);  // Disable fields
        }
        var relevantFields = document.getElementsByClassName(category);
        for (var m = 0; m < relevantFields.length; m++) {
            relevantFields[m].style.display = "block";
            disableFields(relevantFields[m], false);  // Enable fields
        }
    }

    function disableFields(container, disabled) {
        var inputs = container.getElementsByTagName('input');
        var selects = container.getElementsByTagName('select');
        var textareas = container.getElementsByTagName('textarea');
        for (var item of [...inputs, ...selects, ...textareas]) {
            item.disabled = disabled;
        }
    }

    document.addEventListener('DOMContentLoaded', function() {
        showFields(); // existing functionality
        document.getElementById('category').addEventListener('change', showFields);

        document.body.addEventListener('click', function(event) {
            if (event.target.id === 'addCameraSpec') {
                event.preventDefault(); // Prevent form submission or any default action
                console.log("Adding new camera specification field");
                var newField = document.createElement("div");
                newField.innerHTML = '<input type="text" name="camera_specs_type[]" placeholder="Type" required> <input type="text" name="camera_specs_mp[]" placeholder="MP" required>';
                document.getElementById('camera_specifications').appendChild(newField);
            } else if (event.target.id === 'addLesson') {
                event.preventDefault();
                console.log("Adding new lesson field");
                var newField = document.createElement("div");
                newField.innerHTML = '<input type="text" name="lessons[]" placeholder="Lesson topic" required>';
                document.getElementById('lessonSpecifications').appendChild(newField);
            }
        });
    });
</script>

</head>
<body onload="showFields()"> <!-- Ensure fields are correctly shown/hidden on page load -->
<form action="/add_or_update_item{{ '/'+item['_id'] if item else '' }}" method="POST" class="container">
    <h1>{{ 'Update' if item else 'Add New' }} Item</h1>
    <hr>

    <label for="category"><b>Category:</b></label>
    <select name="category" id="category" onchange="showFields()" required>
        <option value="">Select a category</option>
        <option value="vehicles">Vehicles</option>
        <option value="computers">Computers</option>
        <option value="phones">Phones</option>
        <option value="lessons">Private Lessons</option>
    </select>
    <!-- Fields for Vehicles -->
    <div class="field vehicles" style="display:none">
        <label for="title">Title:</label>
        <input type="text" name="title" id="title" required><br>
        
        <label for="type">Type:</label>
        <input type="text" name="type" id="type" ><br>
        
        <label for="brand">Brand:</label>
        <input type="text" name="brand" id="brand" ><br>
        
        <label for="model">Model:</label>
        <input type="text" name="model" id="model" ><br>
        
        <label for="year">Year:</label>
        <input type="number" name="year" id="year" ><br>
        
        <label for="color">Color:</label>
        <input type="text" name="color" id="color" ><br>
        
        <label for="engine_displacement">Engine Displacement (cc):</label>
        <input type="number" name="engine_displacement" id="engine_displacement" ><br>
        
        <label for="fuel_type">Fuel Type:</label>
        <select name="fuel_type" id="fuel_type" >
            <option value="petrol">Petrol</option>
            <option value="diesel">Diesel</option>
            <option value="electric">Electric</option>
        </select><br>
        
        <label for="transmission_type">Transmission Type:</label>
        <select name="transmission_type" id="transmission_type" >
            <option value="automatic">Automatic</option>
            <option value="manual">Manual</option>
        </select><br>
        
        <label for="mileage">Mileage (km or miles):</label>
        <input type="number" name="mileage" id="mileage" ><br>
        
        <label for="price">Price:</label>
        <input type="number" name="price" id="price" required><br>
        
        <label for="image">Image URL:</label>
        <input type="url" name="image_link" id="image_link"><br>
        
        <label for="description">Description:</label>
        <textarea name="description" id="description" required></textarea><br>
    </div>
    
    <!-- Fields for Computers -->
    <div class="field computers" style="display:none">
        <label for="title_computers">Title:</label>
        <input type="text" name="title" id="title" required><br>
    
        <label for="type_computers">Type:</label>
        <select name="type" id="type">
            <option value="tablet">Tablet</option>
            <option value="notebook">Notebook</option>
            <option value="desktop">Desktop</option>
            <!-- Add more types as needed -->
        </select><br>
    
        <label for="brand_computers">Brand:</label>
        <input type="text" name="brand" id="brand" ><br>
        
        <label for="model_computers">Model:</label>
        <input type="text" name="model" id="model" ><br>
        
        <label for="year_computers">Year:</label>
        <input type="number" name="year" id="year" ><br>
        
        <label for="processor_computers">Processor:</label>
        <input type="text" name="processor" id="processor" ><br>
        
        <label for="ram_computers">RAM:</label>
        <input type="text" name="ram" id="ram" ><br>
        
        <label for="storage_computers">Storage:</label>
        <input type="text" name="storage" id="storage" ><br>
        
        <label for="graphics_card_computers">Graphics Card:</label>
        <input type="text" name="graphics_card" id="graphics_card"><br>
        
        <label for="os_computers">Operating System:</label>
        <input type="text" name="operating_system" id="operating_system" ><br>
        
        <label for="price_computers">Price:</label>
        <input type="number" name="price" id="price" required><br>
        
        <label for="image_computers">Image URL:</label>
        <input type="url" name="image_link" id="image_link"><br>
        
        <label for="description_computers">Description:</label>
        <textarea name="description" id="description" required></textarea><br>
    </div>
    
    <!-- Fields for Phones -->
    <div class="field phones" style="display:none">
        <label for="title_phones">Title:</label>
        <input type="text" name="title" id="title" required><br>

        <label for="brand_phones">Brand:</label>
        <input type="text" name="brand" id="brand" ><br>

        <label for="model_phones">Model:</label>
        <input type="text" name="model" id="model" ><br>

        <label for="year_phones">Year:</label>
        <input type="number" name="year" id="year" ><br>

        <label for="os_phones">Operating System:</label>
        <input type="text" name="operating_system" id="operating_system" ><br>

        <label for="processor_phones">Processor:</label>
        <input type="text" name="processor" id="processor"><br>

        <label for="ram_phones">RAM:</label>
        <input type="text" name="ram" id="ram" ><br>

        <label for="storage_phones">Storage:</label>
        <input type="text" name="storage" id="storage" ><br>

        <div id="camera_specifications">
            <label>Camera Specifications:</label>
            <button type="button" id="addCameraSpec">Add Camera Specification</button>
        </div>

        <label for="battery_phones">Battery Capacity:</label>
        <input type="text" name="battery_capacity" id="battery_capacity" ><br>

        <label for="price_phones">Price:</label>
        <input type="number" name="price" id="price" required><br>

        <label for="image_phones">Image URL:</label>
        <input type="url" name="image_link" id="image_link"><br>

        <label for="description_phones">Description:</label>
        <textarea name="description" id="description" required></textarea><br>
    </div>
    
    <!-- Fields for Private Lessons -->
    <div class="field lessons" style="display:none">
        <label for="title_lessons">Title:</label>
        <input type="text" name="title" id="title" required><br>

        <label for="tutor_name">Tutor Name:</label>
        <input type="text" name="tutor_name" id="tutor_name" ><br>

         <div id="lessonSpecifications">
            <label>Lessons:</label>
         <button type="button" id="addLesson">Add Lesson</button>
        </div>

        <label for="location">Location:</label>
        <input type="text" name="location" id="location" ><br>

        <label for="duration">Duration:</label>
        <input type="text" name="duration" id="duration" ><br>

        <label for="price_lessons">Price:</label>
        <input type="number" name="price" id="price" required><br>

        <label for="image_link">Image URL:</label>
        <input type="url" name="image_link" id="image_link"><br>

        <label for="description">Description:</label>
        <textarea name="description" id="description" required></textarea><br>
    </div>
    
    <button type="submit" class="btn">{{ 'Update' if item else 'Add' }} Item</button>

</form>
</body>
</html>